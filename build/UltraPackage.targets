<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Layout" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
      <_RepoRootFiles Include="$(RepoRoot)/**/*.*" Exclude="$(RepoRoot)/artifactsSandBox/**/*.*;$(RepoRoot)/nuget/**/*.*;$(RepoRoot)/artifacts/**/*.*" />
      <_RepoRootFiles2 Include="$(RepoRoot)/artifacts/$(Rid)/**/*.*" />
  </ItemGroup>

  <Target Name="UltraAll" DependsOnTargets="Prepare;Compile;RunAllSandBoxAndPackage">
  </Target>

  <ItemGroup>
    <LinuxDistrosNeedNativeInstaller Include="ubuntu.16.04-x64">
      <DockerFolder>ubuntu.16.04</DockerFolder>
      <InstallerExtension>deb</InstallerExtension>
      <RepositoryId>$(ubuntu1604x64RepositoryId)</RepositoryId>
    </LinuxDistrosNeedNativeInstaller>
    <LinuxDistrosNeedNativeInstaller Include="ubuntu.16.10-x64">
      <DockerFolder>ubuntu.16.10</DockerFolder>
      <InstallerExtension>deb</InstallerExtension>
      <RepositoryId>$(ubuntu1610x64RepositoryId)</RepositoryId>
    </LinuxDistrosNeedNativeInstaller>
  </ItemGroup>

  <Target Name="RunAllSandBoxAndPackage" >
      <MSBuild Projects="$(MSBuildThisFileDirectory)/SandBoxAndPackageInParallel.proj" 
      Targets="RunAllSandBoxAndPackageInParallel"
            Properties="RepoRoot=$(RepoRoot);
            LinuxDistrosNeedNativeInstaller=%(LinuxDistrosNeedNativeInstaller.Identity);
            DockerFolder=%(LinuxDistrosNeedNativeInstaller.DockerFolder);
            BuildConfiguration=$(BuildConfiguration);
            InstallerOutputDirectory=$(InstallerOutputDirectory);
            BuildInParallel='true'
            " />
  </Target>

  <Target Name="MultiPublish" DependsOnTargets="OverrideGeneratedInstaller;Publish">
    
  </Target>

  <Target Name="OverrideGeneratedInstaller">
    <ItemGroup>
      <GeneratedInstallers Include="$(InstallerOutputDirectory)/$(DistroSpecificArtifactNameWithVersionCombinedHostHostFxrFrameworkSdkWithoutHostMonikerRid)%(LinuxDistrosNeedNativeInstaller.Identity).%(LinuxDistrosNeedNativeInstaller.InstallerExtension)" />
    </ItemGroup>
  </Target>
</Project>